{
	"type": "EVENT_BUTTON",
	"name": "submit_workorder",
	"serverCode": "$reqID = $params[\"reqID\"];\n$user = $_SESSION[\"UserID\"];\n$now = now(); // current timestamp\n\n// Fetch the source record from mentain_workorder\n$rs = DB::Select(\"mentain_workorder\", array(\"reqID\" => $reqID));\n$data = $rs->fetchAssoc();\n\n// Prepare data to insert into mentain_workshop\n$insert = array(\n    \"workorder_id\" => $data[\"reqID\"],\n    \"reqID\" => $data[\"reqID\"],\n    \"Station\" => $data[\"Station\"],\n    \"region\" => $data[\"region\"],\n    \"vehNo\" => $data[\"vehNo\"],\n    \"servicetype\" => $data[\"servicetype\"],\n    \"description\" => $data[\"description\"],\n    \"KMR\" => $data[\"KMR\"],\n    \"requestedby\" => $data[\"requestedby\"],\n    \"requestedon\" => $data[\"requestedon\"],\n    \"arrivaltime\" => $data[\"arrivaltime\"],\n    \"arrivaldate\" => $data[\"arrivaldate\"],\n    \"vehType\" => $data[\"vehType\"],\n    \"chasisNo\" => $data[\"chasisNo\"],\n    \"repairInstruction\" => $data[\"repairInstruction\"],\n    \"KMRin\" => $data[\"KMRin\"],\n    \"KMRout\" => $data[\"KMRout\"],\n    \"WOreqBy\" => $user,\n    \"WOreqOn\" => $now,\n    \"status\" => 3\n);\n\n// Insert into mentain_workshop\nDB::Insert(\"mentain_workshop\", $insert);\n\n// Update mentain_workorder: status + WOreqBy + WOreqOn\nDB::Update(\"mentain_workorder\", array(\n    \"status\" => 3,\n    \"WOreqBy\" => $user,\n    \"WOreqOn\" => $now\n), array(\"reqID\" => $reqID));\n\n// Update mentain_req_stn: status only\nDB::Update(\"mentain_req_stn\", array(\n    \"status\" => 3\n), array(\"reqID\" => $reqID));\n\n// Success message\n$result[\"message\"] = \"âœ… Work order copied and updated successfully.\";\n",
	"beforeJsCode": "params[\"reqID\"] = row.getFieldValue(\"reqID\");\n",
	"afterJsCode": "\nlocation.reload();"
}